---
title: "Question2"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#### Goal

Explore the relationship between ldl levels and the categorical variables in the data set.


```{r}
load('heart.Rdata')
library(ggplot2)
```


##### Try to understand the different distributions of the ldl level in the two categories, by a Boxplot:
```{r}
ggplot(data = heart, aes(y=heart$ldl, x=heart$famhist, col=heart$famhist))+ 
  geom_boxplot()+
  xlab('Family history')+
  ylab('ldl')+
  ggtitle('different distribution in ldl for the two family types')+
  labs(col="family history")
```



from this first plot, we can already notice a difference in the distribution of the quantiles, for the two categories, even if there are quite much overlapping between the two boxes.
As expected, the median of the ldl value for the people without any cases of diseas in his family history, is lower. The values of the other quantiles follow this trend.




##### Divide the dataset in the two categories of Famhist
```{r}
heart_fam_yes <- heart[heart$famhist == 'Present',]
heart_fam_no <- heart[heart$famhist == 'Absent',]
```

##### histogram for the two category, separated
```{r}
ggplot(heart_fam_no, aes(x=heart_fam_no$ldl, color = heart_fam_no$famhist)) +
  geom_histogram(fill="#F8766D", binwidth = 1) +
  xlab("ldl") +
  labs(color="familiy history")

ggplot(heart_fam_yes, aes(x=heart_fam_yes$ldl, color=heart_fam_yes$famhist )) +
  geom_histogram(fill='#00BFC4', binwidth = 1) +
  xlab("ldl") +
  labs(color="familiy history")
```

##### and together
```{r}

#calculate the mean for the two groups of family history
mean.absent <- mean(heart_fam_no$ldl)
mean.present <- mean(heart_fam_yes$ldl)
library(plyr)
mu <- ddply(heart, .(famhist), summarise, grp.mean=mean(heart$ldl))
mu$grp.mean[1] <- mean.absent
mu$grp.mean[2] <- mean.present

#plot the graph
ggplot(heart, aes(x=(heart$ldl), fill=heart$famhist)) +
  geom_histogram(aes(y=..density..), alpha=0.7, position=position_dodge(), bins = 30)+
  geom_vline(data=mu, aes(xintercept=grp.mean, color=c('Absent','Present')),
             linetype="dashed")+
  geom_density(alpha=0.4)+
  labs(fill="familiy history", color = "mean")+
  xlab("ldl") +
  ylab("distribution")
```


here the difference in term of distribution enhance the tendency of having slightly high ldl for people with a Present value in Famhist.


##### discretize the continuous variable ldl, in three categories, using the quantiles
```{r}
xs=quantile(heart$ldl,c(0,1/3,2/3,1))
xs[1]=xs[1]-.00005
heart$discr.ldl <- cut(heart$ldl, breaks = xs, labels = c('low','medium','high'))
```

##### mosaic plot
```{r}
library("vcd")
table.heart=xtabs(~famhist+discr.ldl, data=heart)
mosaic(table.heart, gp=shading_max, split_vertical=TRUE)
```
the mosaic plot, show the difference between a null model (independence) and our dataset. The two red areas indicate that there are less cases in the dataset than we expected if the two variables were independent. Viceversa for the blues squares.
As before, the tendency that an absence of heart deseas in family history lead to a low value of ldl, is highlighted.


